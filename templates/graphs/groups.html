{% extends 'base.html' %}
{% block content %}
    {% load staticfiles %}

    <link href={% static "graphs/css/pager.css" %} rel="stylesheet">
    <link href={% static "graphs/css/graphs.css" %} rel="stylesheet">
{#    <script type="text/javascript" src="{% static 'graphs/js/groups.js' %}"></script>#}

    <div class="container-fluid zero-padding padding-bottom-6 padding-top-2">
        <ul class="nav nav-tabs">
            <li class="active text-center">
                <a href="#owner_of" data-toggle="tab">Owner of <span class="badge">{{ owner_of.total }}</span> groups</a>
            </li>
            <li class="text-center">
                <a href="#member_of" data-toggle="tab">Member of <span class="badge">{{ member_of.total }}</span> groups</a>
            </li>

            <li class="text-center">
                <a href="#create_group" data-toggle="tab">Create Group</a>
            </li>
        </ul>

        <div id="myTabContent" class="tab-content container-fluid bg-white padding-top-4">

            <div class="tab-pane fade in active" id="owner_of">
                <table id="OwnedGroupsTable"
                       data-toggle="table"
                       data-show-refresh="true"
                       data-show-columns="true"
                       data-show-toggle="true"
                       data-ajax="groupsPage.ownedGroupsTable.getGroupsByOwner"
                       data-search="true"
                       data-side-pagination="server"
                       data-data-field="groups"
                       data-pagination="true"
                       data-sort-name="name"
                       data-id-field="id"
                       data-sort-order="asc">
                    <thead>
                    <tr>
                        <th data-field="name" data-sortable="True" data-formatter="groupsPage.groupsTable.nameFormatter">Group Name</th>
                        <th data-field="description">Group Description</th>
                        <th data-field="total_graphs">#Graphs</th>
                        <th data-field="total_members">#Members</th>
                        <th data-field="owner_email">Group Owner</th>
                        <th data-field="updated_at" data-formatter="utils.dateFormatter" data-sortable="True">Last Modified</th>
                        <th data-field="operations" data-formatter="groupsPage.groupsTable.operationsFormatter"
                            data-events="groupsPage.groupsTable.operationEvents">
                            Operations
                        </th>
                    </tr>
                    </thead>
                </table>
            </div>

            <div class="tab-pane fade" id="member_of">
                <table id="MemberGroupsTable"
                       data-toggle="table"
                       data-show-refresh="true"
                       data-show-columns="true"
                       data-show-toggle="true"
                       data-ajax="groupsPage.memberGroupsTable.getGroupsByMember"
                       data-search="true"
                       data-side-pagination="server"
                       data-data-field="groups"
                       data-pagination="true"
                       data-sort-name="name"
                       data-id-field="id"
                       data-sort-order="asc">
                    <thead>
                    <tr>
                        <th data-field="name" data-sortable="True" data-formatter="groupsPage.groupsTable.nameFormatter">Group Name</th>
                        <th data-field="description">Group Description</th>
                        <th data-field="total_graphs">#Graphs</th>
                        <th data-field="total_members">#Members</th>
                        <th data-field="owner_email">Group Owner</th>
                        <th data-field="updated_at" data-formatter="utils.dateFormatter" data-sortable="True">Last Modified</th>
                        <th data-field="operations" data-formatter="groupsPage.groupsTable.operationsFormatter"
                            data-events="groupsPage.groupsTable.operationEvents">
                            Operations
                        </th>
                    </tr>
                    </thead>
                </table>
            </div>


            <div class="tab-pane fade" id="create_group">
                <div class="panel panel-default" style="max-width:400px; width:50%; margin: 0 auto;">
                    <div class="panel-body">
                        <form id="CreateGroupForm" role="form">
                            <div class="control-group">
                                <label for="GroupNameInput">Group Name:</label>
                                <input id="GroupNameInput" class="form-control" maxlength="32" type="text"
                                       name="group_name" autocomplete="off" placeholder="Required"/>
                            </div>

                            <br>

                            <div class="control-group">
                                <label for="GroupDescriptionInput">Group Description:</label>
                                <input id="GroupDescriptionInput" class="form-control" maxlength="200" type="text"
                                       name="description" autocomplete="off" placeholder="Optional"/>
                            </div>

                            <br>
                            <button id="CreateGroupBtn" class="btn btn-primary gs-full-width">Create Group</button>
                        </form>
                    </div>
                </div>

            </div>

        </div>

        <div class="modal fade" id="deleteGroupModal" tabindex="-1" role="dialog" aria-labelledby="deleteGroupModal"
             aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="deleteModal">Confirm Delete</h4>
                    </div>
                    <div class="modal-body">

                        <h4>Are you sure you want to delete this group?</h4>
                        <br/>
                        <button type="button" id="ConfirmDeleteGroupBtn" class="btn btn-success">
                            Delete Group
                        </button>
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <br>Powered by <a href="https://www.djangoproject.com/">Django 1.7.6</a>
        <br><a href="http://js.cytoscape.org/">Cytoscape.js 2.5.0</a>
    </footer>

    <!-- JSON support for Groups Page -->
    <script type="text/javascript" src="{% static 'js/utils.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/groups_page.js' %}"></script>

    <script>
        $(document).ready(function () {
            groupsPage.init();
        });
    </script>
{% endblock %}
